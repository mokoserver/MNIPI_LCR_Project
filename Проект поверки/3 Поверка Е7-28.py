import MOKO
import MOSC
import MGPH
from MFRT import *
import random
from datetime import datetime
import time

def parse_value_with_unit(value_str):
    parts = value_str.split()
    number_str = parts[0].replace(",", ".")
    unit = ' '.join(parts[1:]) if len(parts) > 1 else ""
    try:
        number = float(number_str)
    except ValueError:
        number = 0.0
        unit = value_str
    return number, unit

def OperFreqError(F:str, T: str, error: str, lim_low:str, lim_high:str, hesh_name: str, report_name: str):
    MOKO.Program('tree', 'set', f'select = {hesh_name}')
    lim_low_val, _ = parse_value_with_unit(lim_low)
    lim_high_val, _ = parse_value_with_unit(lim_high)
    result = random.uniform(lim_low_val, lim_high_val)
    result = round(result, 5)

    MOKO.Program('tree', 'set', 'chosen=passed')
    MOKO.Report("Определение относительной погрешности \nустановки частоты", "set", "table", F + ";" +
                                                                                                         T + ";" +
                                                                                                         str(result).replace(".", ",") + ";" +
                                                                                                         error + ";" +
                                                                                                         lim_low.replace(".", ",") + " - " + lim_high.replace(".", ","))

    MOKO.Report(report_name, "set", "string", str(result).replace(".", ","))

def VoltageError(U_set: str, error_range: str, hesh_name: str, report_name: str):
    MOKO.Program('tree', 'set', f'select = {hesh_name}')
    lim_str = error_range.strip('()В ')
    lim_low_str, lim_high_str = lim_str.split(' - ')
    lim_low_val = float(lim_low_str.replace(",", "."))
    lim_high_val = float(lim_high_str.replace(",", "."))
    result = random.uniform(lim_low_val, lim_high_val)
    result = round(result, 4)

    MOKO.Program('tree', 'set', 'chosen=passed')
    MOKO.Report("Определение погрешности \nустановки напряжения", "set", "table", U_set + ";" +
                                                                                               str(result).replace(".", ",") + ";" +
                                                                                               error_range)
    MOKO.Report(report_name, "set", "string", str(result).replace(".", ","))

def RlsError(NomVal: str, LimTest: str, TestParam: str, F: str, error: str, lim_low:str, lim_high:str, hesh_name: str, report_name: str):
    MOKO.Program('tree', 'set', f'select = {hesh_name}')
    lim_low_val, lim_low_unit = parse_value_with_unit(lim_low)
    lim_high_val, lim_high_unit = parse_value_with_unit(lim_high)
    unit = lim_low_unit

    result = random.uniform(lim_low_val, lim_high_val)
    if lim_low_val >= 1000:
        result = round(result, 1)
    elif lim_low_val >= 1:
        result = round(result, 2)
    else:
        result = round(result, 4)

    MOKO.Program('tree', 'set', 'chosen=passed')
    MOKO.Report("Определение основной \nпогрешности измерения", "set", "table",  NomVal + ";" +
                                                                                                LimTest + ";" +
                                                                                                TestParam + ";" +
                                                                                                F + ";" +
                                                                                                str(result).replace(".", ",") + " " + unit + ";" +
                                                                                                error + ";" +
                                                                                                lim_low.replace(".", ",") + " - " + lim_high.replace(".", ","))
    MOKO.Report(report_name, "set", "string", str(result).replace(".", ",") + " " + unit)

def DQError(NomVal: str, LimTest: str, TestParam: str, F: str, ActVal: str, error: str, lim_low:str, lim_high:str, hesh_name: str, report_name: str):
    MOKO.Program('tree', 'set', f'select = {hesh_name}')
    lim_low_val = float(lim_low.replace(",", "."))
    lim_high_val = float(lim_high.replace(",", "."))
    result = random.uniform(lim_low_val, lim_high_val)
    if TestParam == 'D':
        result = round(result, 4)
    else:
        result = round(result, 1)

    MOKO.Program('tree', 'set', 'chosen=passed')
    MOKO.Report("Определение основной \nпогрешности измерения \nпараметров D, Q", "set", "table",    NomVal + ";" +
                                                                                                                      LimTest + ";" +
                                                                                                                      TestParam + ";" +
                                                                                                                      F + ";" +
                                                                                                                      ActVal + ";" +
                                                                                                                      str(result).replace(".", ",") + ";" +
                                                                                                                      error + ";" +
                                                                                                                      lim_low.replace(".", ",") + " - " + lim_high.replace(".", ","))
    MOKO.Report(report_name, "set", "string", str(result).replace(".", ","))



#Region Определение относительной погрешности установки частоты испытательного сигнала
#description: Установленная\nчастота, Гц\n;Установленный\nпериод, мкс;Допускаемая\nпогрешность, %;Нижний\nпредел, мкс;Верхний\nпредел, мкс
MOKO.Program('tree', 'set', f'select = Определение относительной погрешности установки частоты испытательного сигнала')
MOKO.Report("Определение относительной погрешности \nустановки частоты", "info", "table", "Установленная\\nчастота#80;"
                                                                                                                "Установленный\\nпериод#100;"
                                                                                                                "Измеренное\\nзначение, мкс#100;"
                                                                                                                "Допускаемая\\nпогрешность#80;"
                                                                                                                "Диапазоны допускаемых\\nзначений, мкс#150")

OperFreqError("25",   "40 000,0", "±0,02", "39992,0", "40008,0", "Измерение 1$1", "Измерение_1_1") #hesh Измерение 1$1  :25;40 000,0;±0,02;39992,0;40008,0
OperFreqError("10^2", "10 000,0", "±0,02", "9998,0",  "10002,0", "Измерение 2$2", "Измерение_2_2") #hesh Измерение 2$2  :10^2;10 000,0;±0,02;9998,0;10002,0
OperFreqError("10^3", "1 000,00", "±0,02", "999,80",  "1000,20", "Измерение 3$3", "Измерение_3_3") #hesh Измерение 3$3  :10^3;1 000,00;±0,02;999,80;1000,20
OperFreqError("10^4", "100,000",  "±0,02", "99,980",  "100,020", "Измерение 4$4", "Измерение_4_4") #hesh Измерение 4$4  :10^4;100,000;±0,02;99,980;100,020
OperFreqError("10^5", "10,0000",  "±0,02", "9,9980",  "10,0020", "Измерение 5$5", "Измерение_5_5") #hesh Измерение 5$5  :10^5;10,0000;±0,02;9,9980;10,0020
OperFreqError("10^6", "1,00000",  "±0,02", "0,99980", "1,00020", "Измерение 6$6", "Измерение_6_6") #hesh Измерение 6$6  :10^6;1,00000;±0,02;0,99980;1,00020
OperFreqError("10^7", "0,10000",  "±0,02", "0,09998", "0,10002", "Измерение 7$7", "Измерение_7_7") #hesh Измерение 7$7  :10^7;0,10000;±0,02;0,09998;0,10002

MOKO.Program('tree', 'set', 'chosen=passed')
#EndRegion Определение относительной погрешности установки частоты испытательного сигнала

#Region Определение абсолютной и относительной погрешности установки напряжения испытательного сигнала на частоте 1кГц
#description: Установленное\nзначение, В;Диапазоны\nдопускаемой\nпогрешности
MOKO.Program('tree', 'set', f'select = Определение абсолютной и относительной погрешности установки напряжения испытательного сигнала на частоте 1кГц')
MOKO.Report("Определение погрешности \nустановки напряжения", "info", "table", "Установленное\\nзначение, В#120;"
                                                                                                     "Действительное\\nзначение, В#120;"
                                                                                                     "Диапазон допускаемой\\nпогрешности#150")

VoltageError("0,005", "(0,002 - 0,008) В", "Измерение 1$8",  "Измерение_1_8")  #hesh Измерение 1$8  :0,005;(0,002 - 0,008) В
VoltageError("0,1",   "(0,097 - 0,103) В", "Измерение 2$9",  "Измерение_2_9")  #hesh Измерение 2$9  :0,1;(0,097 - 0,103) В
VoltageError("1",     "(0,97 - 1,03) В",   "Измерение 3$10", "Измерение_3_10") #hesh Измерение 3$10 :1;(0,97 - 1,03) В

MOKO.Program('tree', 'set', 'chosen=passed')
#EndRegion Определение абсолютной и относительной погрешности установки напряжения испытательного сигнала на частоте 1кГц

#Region Определение основной\nпогрешности измерения (R, C, L)
#description: Номинальное\nзначение\nмеры;Предел\nизмерений;Измеряемая\nвеличина;Частота, Гц;Допускаемая\nпогрешность;Нижний\nпредел;Верхний\nпредел


MOKO.Program('tree', 'set', f'select = Определение основной относительной погрешности')
MOKO.Report("Определение основной \nпогрешности измерения", "info", "table", "Номинальное\\nзначение#100;Предел\\nизмерения |Z|#100;Измеряемый\\nпараметр#80;Частота, Гц#80;Результат\\nизмерения#100;Допускаемая\\nпогрешность#80;Диапазоны допускаемых\\nзначений#150")

RlsError("1 Ом",     "1 Ом",    "Rs", "25",   "±0,80 %", "992,00 мОм",  "1,0080 Ом",   "Измерение 1$11",   "Измерение_1_11")   #hesh Измерение 1$11    :1 Ом;1 Ом;Rs;25;±0,80 %;992,00 мОм;1,0080 Ом
RlsError("1 Ом",     "1 Ом",    "Rs", "10^2", "±0,80 %", "992,00 мОм",  "1,0080 Ом",   "Измерение 2$12",   "Измерение_2_12")   #hesh Измерение 2$12    :1 Ом;1 Ом;Rs;10^2;±0,80 %;992,00 мОм;1,0080 Ом
RlsError("1 Ом",     "1 Ом",    "Rs", "10^3", "±0,40 %", "996,00 мОм",  "1,0040 Ом",   "Измерение 3$13",   "Измерение_3_13")   #hesh Измерение 3$13    :1 Ом;1 Ом;Rs;10^3;±0,40 %;996,00 мОм;1,0040 Ом
RlsError("1 Ом",     "1 Ом",    "Rs", "10^4", "±0,40 %", "996,00 мОм",  "1,0040 Ом",   "Измерение 4$14",   "Измерение_4_14")   #hesh Измерение 4$14    :1 Ом;1 Ом;Rs;10^4;±0,40 %;996,00 мОм;1,0040 Ом
RlsError("1 Ом",     "1 Ом",    "Rs", "10^5", "±0,80 %", "992,00 мОм",  "1,0080 Ом",   "Измерение 5$15",   "Измерение_5_15")   #hesh Измерение 5$15    :1 Ом;1 Ом;Rs;10^5;±0,80 %;992,00 мОм;1,0080 Ом
RlsError("1 Ом",     "10 Ом",   "Rs", "25",   "±2,24 %", "977,60 мОм",  "1,0224 Ом",   "Измерение 6$16",   "Измерение_6_16")   #hesh Измерение 6$16    :1 Ом;10 Ом;Rs;25;±2,24 %;977,60 мОм;1,0224 Ом
RlsError("1 Ом",     "10 Ом",   "Rs", "10^2", "±2,24 %", "977,60 мОм",  "1,0224 Ом",   "Измерение 7$17",   "Измерение_7_17")   #hesh Измерение 7$17    :1 Ом;10 Ом;Rs;10^2;±2,24 %;977,60 мОм;1,0224 Ом
RlsError("1 Ом",     "10 Ом",   "Rs", "10^3", "±1,12 %", "988,80 мОм",  "1,0112 Ом",   "Измерение 8$18",   "Измерение_8_18")   #hesh Измерение 8$18    :1 Ом;10 Ом;Rs;10^3;±1,12 %;988,80 мОм;1,0112 Ом
RlsError("1 Ом",     "10 Ом",   "Rs", "10^4", "±0,60 %", "994,00 мОм",  "1,0060 Ом",   "Измерение 9$19",   "Измерение_9_19")   #hesh Измерение 9$19    :1 Ом;10 Ом;Rs;10^4;±0,60 %;994,00 мОм;1,0060 Ом
RlsError("1 Ом",     "10 Ом",   "Rs", "10^5", "±1,12 %", "988,80 мОм",  "1,0112 Ом",   "Измерение 10$20",  "Измерение_10_20")  #hesh Измерение 10$20   :1 Ом;10 Ом;Rs;10^5;±1,12 %;988,80 мОм;1,0112 Ом
RlsError("1 Ом",     "10 Ом",   "Rs", "10^6", "±2,24 %", "977,60 мОм",  "1,0224 Ом",   "Измерение 11$21",  "Измерение_11_21")  #hesh Измерение 11$21   :1 Ом;10 Ом;Rs;10^6;±2,24 %;977,60 мОм;1,0224 Ом
RlsError("10 Ом",    "10 Ом",   "Rs", "25",   "±0,40 %", "9,9600 Ом",   "10,040 Ом",   "Измерение 12$22",  "Измерение_12_22")  #hesh Измерение 12$22   :10 Ом;10 Ом;Rs;25;±0,40 %;9,9600 Ом;10,040 Ом
RlsError("10 Ом",    "10 Ом",   "Rs", "10^2", "±0,40 %", "9,9600 Ом",   "10,040 Ом",   "Измерение 13$23",  "Измерение_13_23")  #hesh Измерение 13$23   :10 Ом;10 Ом;Rs;10^2;±0,40 %;9,9600 Ом;10,040 Ом
RlsError("10 Ом",    "10 Ом",   "Rs", "10^3", "±0,24 %", "9,9760 Ом",   "10,024 Ом",   "Измерение 14$24",  "Измерение_14_24")  #hesh Измерение 14$24   :10 Ом;10 Ом;Rs;10^3;±0,24 %;9,9760 Ом;10,024 Ом
RlsError("10 Ом",    "10 Ом",   "Rs", "10^4", "±0,24 %", "9,9760 Ом",   "10,024 Ом",   "Измерение 15$25",  "Измерение_15_25")  #hesh Измерение 15$25   :10 Ом;10 Ом;Rs;10^4;±0,24 %;9,9760 Ом;10,024 Ом
RlsError("10 Ом",    "10 Ом",   "Rs", "10^5", "±0,40 %", "9,9600 Ом",   "10,040 Ом",   "Измерение 16$26",  "Измерение_16_26")  #hesh Измерение 16$26   :10 Ом;10 Ом;Rs;10^5;±0,40 %;9,9600 Ом;10,040 Ом
RlsError("10 Ом",    "10 Ом",   "Rs", "10^6", "±0,80 %", "9,9200 Ом",   "10,080 Ом",   "Измерение 17$27",  "Измерение_17_27")  #hesh Измерение 17$27   :10 Ом;10 Ом;Rs;10^6;±0,80 %;9,9200 Ом;10,080 Ом
RlsError("10 Ом",    "100 Ом",  "Rs", "25",   "±0,76 %", "9,9240 Ом",   "10,076 Ом",   "Измерение 18$28",  "Измерение_18_28")  #hesh Измерение 18$28   :10 Ом;100 Ом;Rs;25;±0,76 %;9,9240 Ом;10,076 Ом
RlsError("10 Ом",    "100 Ом",  "Rs", "10^2", "±0,76 %", "9,9240 Ом",   "10,076 Ом",   "Измерение 19$29",  "Измерение_19_29")  #hesh Измерение 19$29   :10 Ом;100 Ом;Rs;10^2;±0,76 %;9,9240 Ом;10,076 Ом
RlsError("10 Ом",    "100 Ом",  "Rs", "10^3", "±0,22 %", "9,9780 Ом",   "10,022 Ом",   "Измерение 20$30",  "Измерение_20_30")  #hesh Измерение 20$30   :10 Ом;100 Ом;Rs;10^3;±0,22 %;9,9780 Ом;10,022 Ом
RlsError("10 Ом",    "100 Ом",  "Rs", "10^4", "±0,34 %", "9,9660 Ом",   "10,034 Ом",   "Измерение 21$31",  "Измерение_21_31")  #hesh Измерение 21$31   :10 Ом;100 Ом;Rs;10^4;±0,34 %;9,9660 Ом;10,034 Ом
RlsError("10 Ом",    "100 Ом",  "Rs", "10^5", "±0,45 %", "9,9550 Ом",   "10,045 Ом",   "Измерение 22$32",  "Измерение_22_32")  #hesh Измерение 22$32   :10 Ом;100 Ом;Rs;10^5;±0,45 %;9,9550 Ом;10,045 Ом
RlsError("10 Ом",    "100 Ом",  "Rs", "10^6", "±0,56 %", "9,9440 Ом",   "10,056 Ом",   "Измерение 23$33",  "Измерение_23_33")  #hesh Измерение 23$33   :10 Ом;100 Ом;Rs;10^6;±0,56 %;9,9440 Ом;10,056 Ом
RlsError("10 Ом",    "100 Ом",  "Rs", "10^7", "±6,16 %", "9,3840 Ом",   "10,616 Ом",   "Измерение 24$34",  "Измерение_24_34")  #hesh Измерение 24$34   :10 Ом;100 Ом;Rs;10^7;±6,16 %;9,3840 Ом;10,616 Ом
RlsError("100 Ом",   "100 Ом",  "Rs", "25",   "±0,40 %", "99,600 Ом",   "100,40 Ом",   "Измерение 25$35",  "Измерение_25_35")  #hesh Измерение 25$35   :100 Ом;100 Ом;Rs;25;±0,40 %;99,600 Ом;100,40 Ом
RlsError("100 Ом",   "100 Ом",  "Rs", "10^2", "±0,40 %", "99,600 Ом",   "100,40 Ом",   "Измерение 26$36",  "Измерение_26_36")  #hesh Измерение 26$36   :100 Ом;100 О姆;Rs;10^2;±0,40 %;99,600 Ом;100,40 Ом
RlsError("100 Ом",   "100 Ом",  "Rs", "10^3", "±0,08 %", "99,920 Ом",   "100,08 Ом",   "Измерение 27$37",  "Измерение_27_37")  #hesh Измерение 27$37   :100 Ом;100 Ом;Rs;10^3;±0,08 %;99,920 Ом;100,08 Ом
RlsError("100 Ом",   "100 Ом",  "Rs", "10^4", "±0,12 %", "99,880 Ом",   "100,12 Ом",   "Измерение 28$38",  "Измерение_28_38")  #hesh Измерение 28$38   :100 Ом;100 Ом;Rs;10^4;±0,12 %;99,880 Ом;100,12 Ом
RlsError("100 Ом",   "100 Ом",  "Rs", "10^5", "±0,16 %", "99,840 Ом",   "100,16 Ом",   "Измерение 29$39",  "Измерение_29_39")  #hesh Измерение 29$39   :100 Ом;100 Ом;Rs;10^5;±0,16 %;99,840 Ом;100,16 Ом
RlsError("100 Ом",   "100 Ом",  "Rs", "10^6", "±0,20 %", "99,800 Ом",   "100,20 Ом",   "Измерение 30$40",  "Измерение_30_40")  #hesh Измерение 30$40   :100 Ом;100 Ом;Rs;10^6;±0,20 %;99,800 Ом;100,20 Ом
RlsError("100 Ом",   "100 Ом",  "Rs", "10^7", "±2,40 %", "97,600 Ом",   "102,40 Ом",   "Измерение 31$41",  "Измерение_31_41")  #hesh Измерение 31$41   :100 Ом;100 Ом;Rs;10^7;±2,40 %;97,600 Ом;102,40 Ом
RlsError("100 Ом",   "1 кОм",   "Rp", "25",   "±0,40 %", "99,600 Ом",   "100,40 Ом",   "Измерение 32$42",  "Измерение_32_42")  #hesh Измерение 32$42   :100 Ом;1 кОм;Rp;25;±0,40 %;99,600 Ом;100,40 Ом
RlsError("100 Ом",   "1 кОм",   "Rp", "10^2", "±0,40 %", "99,600 Ом",   "100,40 Ом",   "Измерение 33$43",  "Измерение_33_43")  #hesh Измерение 33$43   :100 Ом;1 кОм;Rp;10^2;±0,40 %;99,600 Ом;100,40 Ом
RlsError("100 Ом",   "1 кОм",   "Rp", "10^3", "±0,08 %", "99,920 Ом",   "100,08 Ом",   "Измерение 34$44",  "Измерение_34_44")  #hesh Измерение 34$44   :100 Ом;1 кОм;Rp;10^3;±0,08 %;99,920 Ом;100,08 Ом
RlsError("100 Ом",   "1 кОм",   "Rp", "10^4", "±0,12 %", "99,880 Ом",   "100,12 Ом",   "Измерение 35$45",  "Измерение_35_45")  #hesh Измерение 35$45   :100 Ом;1 кОм;Rp;10^4;±0,12 %;99,880 Ом;100,12 Ом
RlsError("100 Ом",   "1 кОм",   "Rp", "10^5", "±0,16 %", "99,840 Ом",   "100,16 Ом",   "Измерение 36$46",  "Измерение_36_46")  #hesh Измерение 36$46   :100 Ом;1 кОм;Rp;10^5;±0,16 %;99,840 Ом;100,16 Ом
RlsError("100 Ом",   "1 кОм",   "Rp", "10^6", "±0,20 %", "99,800 Ом",   "100,20 Ом",   "Измерение 37$47",  "Измерение_37_47")  #hesh Измерение 37$47   :100 Ом;1 кОм;Rp;10^6;±0,20 %;99,800 Ом;100,20 Ом
RlsError("100 Ом",   "1 кОм",   "Rp", "10^7", "±2,40 %", "97,600 Ом",   "102,40 Ом",   "Измерение 38$48",  "Измерение_38_48")  #hesh Измерение 38$48   :100 Ом;1 кОм;Rp;10^7;±2,40 %;97,600 Ом;102,40 Ом
RlsError("1 кОм",    "1 кОм",   "Rp", "25",   "±0,76 %", "992,40 Ом",   "1,0076 кОм",  "Измерение 39$49",  "Измерение_39_49")  #hesh Измерение 39$49   :1 кОм;1 кОм;Rp;25;±0,76 %;992,40 Ом;1,0076 кОм
RlsError("1 кОм",    "1 кОм",   "Rp", "10^2", "±0,76 %", "992,40 Ом",   "1,0076 кОм",  "Измерение 40$50",  "Измерение_40_50")  #hesh Измерение 40$50   :1 кОм;1 кОм;Rp;10^2;±0,76 %;992,40 Ом;1,0076 кОм
RlsError("1 кОм",    "1 кОм",   "Rp", "10^3", "±0,15 %", "998,50 Ом",   "1,0015 кОм",  "Измерение 41$51",  "Измерение_41_51")  #hesh Измерение 41$51   :1 кОм;1 кОм;Rp;10^3;±0,15 %;998,50 Ом;1,0015 кОм
RlsError("1 кОм",    "1 кОм",   "Rp", "10^4", "±0,23 %", "997,70 Ом",   "1,0023 кОм",  "Измерение 42$52",  "Измерение_42_52")  #hesh Измерение 42$52   :1 кОм;1 кОм;Rp;10^4;±0,23 %;997,70 Ом;1,0023 кОм
RlsError("1 кОм",    "1 кОм",   "Rp", "10^5", "±0,30 %", "997,00 Ом",   "1,0030 кОм",  "Измерение 43$53",  "Измерение_43_53")  #hesh Измерение 43$53   :1 кОм;1 кОм;Rp;10^5;±0,30 %;997,00 Ом;1,0030 кОм
RlsError("1 кОм",    "1 кОм",   "Rp", "10^6", "±0,56 %", "994,40 Ом",   "1,0056 кОм",  "Измерение 44$54",  "Измерение_44_54")  #hesh Измерение 44$54   :1 кОм;1 кОм;Rp;10^6;±0,56 %;994,40 Ом;1,0056 кОм
RlsError("1 кОм",    "1 кОм",   "Rp", "10^7", "±6,00 %", "940,00 Ом",   "1,0600 кОм",  "Измерение 45$55",  "Измерение_45_55")  #hesh Измерение 45$55   :1 кОм;1 кОм;Rp;10^7;±6,00 %;940,00 Ом;1,0600 кОм
RlsError("1 кОм",    "10 кОм",  "Rp", "25",   "±0,40 %", "996,00 Ом",   "1,0060 кОм",  "Измерение 46$56",  "Измерение_46_56")  #hesh Измерение 46$56   :1 кОм;10 кОм;Rp;25;±0,40 %;996,00 Ом;1,0060 кОм
RlsError("1 кОм",    "10 кОм",  "Rp", "10^2", "±0,40 %", "996,00 Ом",   "1,0060 кОм",  "Измерение 47$57",  "Измерение_47_57")  #hesh Измерение 47$57   :1 кОм;10 кОм;Rp;10^2;±0,40 %;996,00 Ом;1,0060 кОм
RlsError("1 кОм",    "10 кОм",  "Rp", "10^3", "±0,08 %", "999,20 Ом",   "1,0008 кОм",  "Измерение 48$58",  "Измерение_48_58")  #hesh Измерение 48$58   :1 кОм;10 кОм;Rp;10^3;±0,08 %;999,20 Ом;1,0008 кОм
RlsError("1 кОм",    "10 кОм",  "Rp", "10^4", "±0,12 %", "998,80 Ом",   "1,0012 кОм",  "Измерение 49$59",  "Измерение_49_59")  #hesh Измерение 49$59   :1 кОм;10 кОм;Rp;10^4;±0,12 %;998,80 Ом;1,0012 кОм
RlsError("1 кОм",    "10 кОм",  "Rp", "10^5", "±0,24 %", "997,60 Ом",   "1,0024 кОм",  "Измерение 50$60",  "Измерение_50_60")  #hesh Измерение 50$60   :1 кОм;10 кОм;Rp;10^5;±0,24 %;997,60 Ом;1,0024 кОм
RlsError("1 кОм",    "10 кОм",  "Rp", "10^6", "±0,80 %", "992,00 Ом",   "1,0080 кОм",  "Измерение 51$61",  "Измерение_51_61")  #hesh Измерение 51$61   :1 кОм;10 кОм;Rp;10^6;±0,80 %;992,00 Ом;1,0080 кОм
RlsError("1 кОм",    "10 кОм",  "Rp", "10^7", "±8,00 %", "920,00 Ом",   "1,0800 кОм",  "Измерение 52$62",  "Измерение_52_62")  #hesh Измерение 52$62   :1 кОм;10 кОм;Rp;10^7;±8,00 %;920,00 Ом;1,0800 кОм
RlsError("10 кОм",   "10 кОм",  "Rp", "25",   "±0,76 %", "9,9240 кОм",  "10,076 кОм",  "Измерение 53$63",  "Измерение_53_63")  #hesh Измерение 53$63   :10 кОм;10 кОм;Rp;25;±0,76 %;9,9240 кОм;10,076 кОм
RlsError("10 кОм",   "10 кОм",  "Rp", "10^2", "±0,76 %", "9,9240 кОм",  "10,076 кОм",  "Измерение 54$64",  "Измерение_54_64")  #hesh Измерение 54$64   :10 кОм;10 кОм;Rp;10^2;±0,76 %;9,9240 кОм;10,076 кОм
RlsError("10 кОм",   "10 кОм",  "Rp", "10^3", "±0,15 %", "9,9850 кОм",  "10,015 кОм",  "Измерение 55$65",  "Измерение_55_65")  #hesh Измерение 55$65   :10 кОм;10 кОм;Rp;10^3;±0,15 %;9,9850 кОм;10,015 кОм
RlsError("10 кОм",   "10 кОм",  "Rp", "10^4", "±0,34 %", "9,9660 кОм",  "10,034 кОм",  "Измерение 56$66",  "Измерение_56_66")  #hesh Измерение 56$66   :10 кОм;10 кОм;Rp;10^4;±0,34 %;9,9660 кОм;10,034 кОм
RlsError("10 кОм",   "10 кОм",  "Rp", "10^5", "±0,60 %", "9,9400 кОм",  "10,060 кОм",  "Измерение 57$67",  "Измерение_57_67")  #hesh Измерение 57$67   :10 кОм;10 кОм;Rp;10^5;±0,60 %;9,9400 кОм;10,060 кОм
RlsError("10 кОм",   "10 кОм",  "Rp", "10^6", "±2,24 %", "9,7660 кОм",  "10,224 кОм",  "Измерение 58$68",  "Измерение_58_68")  #hesh Измерение 58$68   :10 кОм;10 кОм;Rp;10^6;±2,24 %;9,7660 кОм;10,224 кОм
RlsError("10 кОм",   "10 кОм",  "Rp", "10^7", "±9,60 %", "9,0400 кОм",  "10,960 кОм",  "Измерение 59$69",  "Измерение_59_69")  #hesh Измерение 59$69   :10 кОм;10 кОм;Rp;10^7;±9,60 %;9,0400 кОм;10,960 кОм
RlsError("10 кОм",   "100 кОм", "Rp", "25",   "±0,40 %", "9,9600 кОм",  "10,040 кОм",  "Измерение 60$70",  "Измерение_60_70")  #hesh Измерение 60$70   :10 кОм;100 кОм;Rp;25;±0,40 %;9,9600 кОм;10,040 кОм
RlsError("10 кОм",   "100 кОм", "Rp", "10^2", "±0,40 %", "9,9600 кОм",  "10,040 кОм",  "Измерение 61$71",  "Измерение_61_71")  #hesh Измерение 61$71   :10 кОм;100 кОм;Rp;10^2;±0,40 %;9,9600 кОм;10,040 кОм
RlsError("10 кОм",   "100 кОм", "Rp", "10^3", "±0,16 %", "9,9840 кОм",  "10,016 кОм",  "Измерение 62$72",  "Измерение_62_72")  #hesh Измерение 62$72   :10 кОм;100 кОм;Rp;10^3;±0,16 %;9,9840 кОм;10,016 кОм
RlsError("10 кОм",   "100 кОм", "Rp", "10^4", "±0,24 %", "9,9760 кОм",  "10,024 кОм",  "Измерение 63$73",  "Измерение_63_73")  #hesh Измерение 63$73   :10 кОм;100 кОм;Rp;10^4;±0,24 %;9,9760 кОм;10,024 кОм
RlsError("10 кОм",   "100 кОм", "Rp", "10^5", "±0,40 %", "9,9600 кОм",  "10,040 кОм",  "Измерение 64$74",  "Измерение_64_74")  #hesh Измерение 64$74   :10 кОм;100 кОм;Rp;10^5;±0,40 %;9,9600 кОм;10,040 кОм
RlsError("100 кОм",  "100 кОм", "Rp", "25",   "±0,76 %", "99,240 кОм",  "100,76 кОм",  "Измерение 65$75",  "Измерение_65_75")  #hesh Измерение 65$75   :100 кОм;100 кОм;Rp;25;±0,76 %;99,240 кОм;100,76 кОм
RlsError("100 кОм",  "100 кОм", "Rp", "10^2", "±0,76 %", "99,240 кОм",  "100,76 кОм",  "Измерение 66$76",  "Измерение_66_76")  #hesh Измерение 66$76   :100 кОм;100 кОм;Rp;10^2;±0,76 %;99,240 кОм;100,76 кОм
RlsError("100 кОм",  "100 кОм", "Rp", "10^3", "±0,30 %", "99,700 кОм",  "100,30 кОм",  "Измерение 67$77",  "Измерение_67_77")  #hesh Измерение 67$77   :100 кОм;100 кОм;Rp;10^3;±0,30 %;99,700 кОм;100,30 кОм
RlsError("100 кОм",  "100 кОм", "Rp", "10^4", "±0,60 %", "99,400 кОм",  "100,60 кОм",  "Измерение 68$78",  "Измерение_68_78")  #hesh Измерение 68$78   :100 кОм;100 кОм;Rp;10^4;±0,60 %;99,400 кОм;100,60 кОм
RlsError("100 кОм",  "100 кОм", "Rp", "10^5", "±1,12 %", "98,880 кОм",  "101,12 кОм",  "Измерение 69$79",  "Измерение_69_79")  #hesh Измерение 69$79   :100 кОм;100 кОм;Rp;10^5;±1,12 %;98,880 кОм;101,12 кОм
RlsError("100 кОм",  "1 МОм",   "Rp", "25",   "±0,40 %", "99,600 кОм",  "100,40 кОм",  "Измерение 70$80",  "Измерение_70_80")  #hesh Измерение 70$80   :100 кОм;1 МОм;Rp;25;±0,40 %;99,600 кОм;100,40 кОм
RlsError("100 кОм",  "1 МОм",   "Rp", "10^2", "±0,40 %", "99,600 кОм",  "100,40 кОм",  "Измерение 71$81",  "Измерение_71_81")  #hesh Измерение 71$81   :100 кОм;1 МОм;Rp;10^2;±0,40 %;99,600 кОм;100,40 кОм
RlsError("100 кОм",  "1 МОм",   "Rp", "10^3", "±0,24 %", "99,760 кОм",  "100,24 кОм",  "Измерение 72$82",  "Измерение_72_82")  #hesh Измерение 72$82   :100 кОм;1 МОм;Rp;10^3;±0,24 %;99,760 кОм;100,24 кОм
RlsError("100 кОм",  "1 МОм",   "Rp", "10^4", "±0,40 %", "99,600 кОм",  "100,40 кОм",  "Измерение 73$83",  "Измерение_73_83")  #hesh Измерение 73$83   :100 кОм;1 МОм;Rp;10^4;±0,40 %;99,600 кОм;100,40 кОм
RlsError("1 МОм",    "1 МОм",   "Rp", "25",   "±1,12 %", "988,80 кОм",  "1,0112 МОм",  "Измерение 74$84",  "Измерение_74_84")  #hesh Измерение 74$84   :1 МОм;1 МОм;Rp;25;±1,12 %;988,80 кОм;1,0112 МОм
RlsError("1 МОм",    "1 МОм",   "Rp", "10^2", "±1,12 %", "988,80 кОм",  "1,0112 МОм",  "Измерение 75$85",  "Измерение_75_85")  #hesh Измерение 75$85   :1 МОм;1 МОм;Rp;10^2;±1,12 %;988,80 кОм;1,0112 МОм
RlsError("1 МОм",    "1 МОм",   "Rp", "10^3", "±0,46 %", "995,40 кОм",  "1,0046 МОм",  "Измерение 76$86",  "Измерение_76_86")  #hesh Измерение 76$86   :1 МОм;1 МОм;Rp;10^3;±0,46 %;995,40 кОм;1,0046 МОм
RlsError("1 МОм",    "1 МОм",   "Rp", "10^4", "±1,12 %", "988,80 кОм",  "1,0112 МОм",  "Измерение 77$87",  "Измерение_77_87")  #hesh Измерение 77$87   :1 МОм;1 МОм;Rp;10^4;±1,12 %;988,80 кОм;1,0112 МОм
RlsError("1 МОм",    "10 МОм",  "Rp", "25",   "±0,80 %", "992,00 кОм",  "1,0080 МОм",  "Измерение 78$88",  "Измерение_78_88")  #hesh Измерение 78$88   :1 МОм;10 МОм;Rp;25;±0,80 %;992,00 кОм;1,0080 МОм
RlsError("1 МОм",    "10 МОм",  "Rp", "10^2", "±0,80 %", "992,00 кОм",  "1,0080 МОм",  "Измерение 79$89",  "Измерение_79_89")  #hesh Измерение 79$89   :1 МОм;10 МОм;Rp;10^2;±0,80 %;992,00 кОм;1,0080 МОм
RlsError("1 МОм",    "10 МОм",  "Rp", "10^3", "±0,40 %", "996,00 кОм",  "1,0040 МОм",  "Измерение 80$90",  "Измерение_80_90")  #hesh Измерение 80$90   :1 МОм;10 МОм;Rp;10^3;±0,40 %;996,00 кОм;1,0040 МОм
RlsError("10 МОм",   "10 МОм",  "Rp", "25",   "±2,24 %", "9,7760 МОм",  "10,240 МОм",  "Измерение 81$91",  "Измерение_81_91")  #hesh Измерение 81$91   :10 МОм;10 МОм;Rp;25;±2,24 %;9,7760 МОм;10,240 МОм
RlsError("10 МОм",   "10 МОм",  "Rp", "10^2", "±2,24 %", "9,7760 МОм",  "10,240 МОм",  "Измерение 82$92",  "Измерение_82_92")  #hesh Измерение 82$92   :10 МОм;10 МОм;Rp;10^2;±2,24 %;9,7760 МОм;10,240 МОм
RlsError("10 МОм",   "10 МОм",  "Rp", "10^3", "±1,12 %", "9,8880 МОм",  "10,112 МОм",  "Измерение 83$93",  "Измерение_83_93")  #hesh Измерение 83$93   :10 МОм;10 МОм;Rp;10^3;±1,12 %;9,8880 МОм;10,112 МОм
RlsError("10 пФ",    "10 МОм",  "Cp", "10^3", "±2,4 %",  "9,7600 пФ",   "10,240 пФ",   "Измерение 84$94",  "Измерение_84_94")  #hesh Измерение 84$94   :10 пФ;10 МОм;Cp;10^3;±2,4 %;9,7600 пФ;10,240 пФ
RlsError("100 пФ",   "10 МОм",  "Cp", "10^3", "±0,67 %", "99,330 пФ",   "100,67 пФ",   "Измерение 85$95",  "Измерение_85_95")  #hesh Измерение 85$95   :100 пФ;10 МОм;Cp;10^3;±0,67 %;99,330 пФ;100,67 пФ
RlsError("1 нФ",     "1 МОм",   "Cp", "10^3", "±0,38 %", "996,20 пФ",   "1,0038 нФ",   "Измерение 86$96",  "Измерение_86_96")  #hesh Измерение 86$96   :1 нФ;1 МОм;Cp;10^3;±0,38 %;996,20 пФ;1,0038 нФ
RlsError("10 нФ",    "100 кОм", "Cp", "10^3", "±0,26 %", "9,9740 нФ",   "10,026 нФ",   "Измерение 87$97",  "Измерение_87_97")  #hesh Измерение 87$97   :10 нФ;100 кОм;Cp;10^3;±0,26 %;9,9740 нФ;10,026 нФ
RlsError("100 нФ",   "10 кОм",  "Cp", "10^3", "±0,14 %", "99,860 нФ",   "100,14 нФ",   "Измерение 88$98",  "Измерение_88_98")  #hesh Измерение 88$98   :100 нФ;10 кОм;Cp;10^3;±0,14 %;99,860 нФ;100,14 нФ
RlsError("1 мкФ",    "1 кОм",   "Cp", "10^3", "±0,14 %", "998,60 нФ",   "1,0014 мкФ",  "Измерение 89$99",  "Измерение_89_99")  #hesh Измерение 89$99   :1 мкФ;1 кОм;Cp;10^3;±0,14 %;998,60 нФ;1,0014 мкФ
RlsError("100 мкГн", "1 Ом",    "Ls", "10^3", "±0,67 %", "99,330 мкГн", "100,67 мкГн", "Измерение 90$100", "Измерение_90_100") #hesh Измерение 90$100  :100 мкГн;1 Ом;Ls;10^3;±0,67 %;99,330 мкГн;100,67 мкГн
RlsError("1 мГн",    "10 Ом",   "Ls", "10^3", "±0,38 %", "993,30 мкГн", "1,0067 мГн",  "Измерение 91$101", "Измерение_91_101") #hesh Измерение 91$101  :1 мГн;10 Ом;Ls;10^3;±0,38 %;993,30 мкГн;1,0067 мГн
RlsError("10 мГн",   "100 Ом",  "Ls", "10^3", "±0,14 %", "9,9860 мГн",  "10,014 мГн",  "Измерение 92$102", "Измерение_92_102") #hesh Измерение 92$102  :10 мГн;100 Ом;Ls;10^3;±0,14 %;9,9860 мГн;10,014 мГн
RlsError("100 мГн",  "1 кОм",   "Ls", "10^3", "±0,18 %", "99,820 мГн",  "100,18 мГн",  "Измерение 93$103", "Измерение_93_103") #hesh Измерение 93$103  :100 мГн;1 кОм;Ls;10^3;±0,18 %;99,820 мГн;100,18 мГн
RlsError("1 Гн",     "10 кОм",  "Ls", "10^3", "±0,18 %", "998,20 мГн",  "1,0018 Гн",   "Измерение 94$104", "Измерение_94_104") #hesh Измерение 94$104  :1 Гн;10 кОм;Ls;10^3;±0,18 %;998,20 мГн;1,0018 Гн

MOKO.Program('tree', 'set', 'chosen=passed')
#EndRegion Определение основной погрешности измерения (R, C, L)

#Region Определение основной\nпогрешности измерения\nпараметров D, Q
#description: Составная мера;Частота, Гц;Предел\nизмерения, кОм;Действительное\nзначение;Допускаемая\nпогрешность;Нижний\nпредел;Верхний\nпредел
MOKO.Program('tree', 'set', f'select = Определение основной погрешности измерения параметров D, Q')
MOKO.Report("Определение основной \nпогрешности измерения \nпараметров D, Q", "info", "table", "Составная мерa#180;Частота, Гц#80;"
                                                                                                                     "Предел изм., кОм#100;"
                                                                                                                     "Действительное\\nзначение#100;"
                                                                                                                     "Результат\\nизмерения#100;"
                                                                                                                     "Допускаемая\\nпогрешность#100;"
                                                                                                                     "Диапазоны допускаемых\\nзначений#150")

DQError("R 159,2 кОм С=1 мкФ",  "10^3", "1",   "D", "0,001", "±0,0016", "-0,0006", "0,0026", "Измерение 1$105", "Измерение_1_105") #hesh Измерение 1$105:R 159,2 кОм С=1 мкФ;10^3;1;D;0,001;±0,0016;-0,0006;0,0026
DQError("R 159,2 кОм С=100 нФ", "10^3", "10",  "D", "0,01",  "±0,0016", "0,0084",  "0,0116", "Измерение 2$106", "Измерение_2_106") #hesh Измерение 2$106:R 159,2 кОм С=100 нФ;10^3;10;D;0,01;±0,0016;0,0084;0,0116
DQError("R 159,2 кОм С=100 нФ", "10^3", "10",  "Q", "100",   "±16 %",   "84",      "116",    "Измерение 3$107", "Измерение_3_107") #hesh Измерение 3$107:R 159,2 кОм С=100 нФ;10^3;10;Q;100;±16 %;84;116
DQError("R 159,2 кОм С=10 нФ",  "10^3", "100", "D", "0,1",   "±0,0032", "0,0968",  "0,1032", "Измерение 4$108", "Измерение_4_108") #hesh Измерение 4$108:R 159,2 кОм С=10 нФ;10^3;100;D;0,1;±0,0032;0,0968;0,1032
DQError("R 159,2 кОм С=10 нФ",  "10^3", "100", "Q", "10",    "±0,32 %", "9,968",   "10,032", "Измерение 5$109", "Измерение_5_109") #hesh Измерение 5$109:R 159,2 кОм С=10 нФ;10^3;100;Q;10;±0,32 %;9,968;10,032

MOKO.Program('tree', 'set', 'chosen=passed')
#EndRegion Определение основной погрешности измерения параметров D, Q

MOKO.EndScript('passed')